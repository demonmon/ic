---
title: R = {public_key_x, public_key_y, 0};//基点
updated: 2022-05-30T19:15:44.0000000+08:00
created: 2022-04-27T16:58:16.0000000+08:00
---

![image1](image1-25.png)

R = {public_key_x, public_key_y, 0};//基点
Q = point_at_infinity;//无穷点—O点
Then the algorithm is shown below:
for(i=255; i>=0; i--) { //不是i=0 到255 吗
if(private_key\[i\]) Q = jacobian(Q+R); //私钥从高位到低位 为1的位数需要进行几何加法
R = jacobian(R\*2); 判断完之后进行倍乘类似权重
}

result = jacobian_to_affine(Q); 循环之后返回坐标值产生公钥 x y

![image2](image2-21.png)

空闲：空闲状态
GET：从私钥获取 32 位数据
CALC：jcb_add和jcb_dble的主循环
INV：呼叫gf_inv
TAIL：计算 X/Z 和 Y/Z
A：开始启用
B：两个时钟周期
C：并非所有私钥的位都已循环
D：私钥的所有位都已循环，当前环路完成和反转不包括在内
E：私钥的所有位都已循环，包括电流环路完成和反转
F：求逆完成
G：二乘完成 X/Z 和 Y/Z

![image3](image3-19.png)
通过系统总线（32 位）来控制状态寄存器，寄存器中数据值可以用来配
置复杂功能的控制模块以及基本功能控制模块的开启和关断
复杂功能的控制模块包括椭圆曲线点乘的控制模块、点加与倍点运算的控制模块 模逆运算模块。基本功能的控制模块包括大数乘法运算、大数加减法运算
![image4](image4-16.png)

各个算法模块以及功能模块的输入输出数据
端口都是通过利用传输 SRAM 的地址，再由顶层模块控制 SRAM 的读写控制线来进
行数据的运算或者数据的搬移等等。

**例如：我们将进行一次大数乘法运算，即有两个**
**数据的输入，以及一个运算结果的输出。本设计是将在 SRAM 中存放数据的地址以**
**及地址的长度输入到大数乘法的控制模块，当运算结束之后将结果用 SRAM 的地址**
**和其长度以及读写控制信号输出，然后通过顶层再控制 SRAM 的读写信号线，将该**
**数据存入到大数乘法模块输出的地址中**

**控制寄存器的描述：**
