---
title: ECDSA椭圆曲线数字签名算法
updated: 2022-05-04T17:44:20.0000000+08:00
created: 2022-04-26T16:11:20.0000000+08:00
---

![image1](image1-24.png)
**私钥就是一个整数，用二进制表示的话有256位**；
**G就是那个有固定xy坐标的椭圆曲线循环群生成元；**
![image2](image2-20.png)

签名：
签名运算
输入：私钥dA ，待签名消息M 。 M 包含了 Alice 的身份有关信息。
输出： 签名值（r ，s）。
A1：选择一个随机数k ， k 在1，n-1之间；
A2：计算P=k**G**；
A3：计算r=XPmodn     如果r =0，则返回步骤 A1；
A4：计算，z=Hash(message) H 为摘要运算；
![image3](image3-18.png)
A6：（r ，s） 即为 Alice 对消息的签名，将其发送给 Bob
验证运算：
签名验证就是验证签名是否正确，防止有人伪造签名，如果签名验证通过，那么至少可以证明发出这个文件的确实就是正确的发送方而不是什么别的人。
在说验签之前先需要梳理一下目前接收方的已知量，因为签名是发送方本人签名，而验签是所有人都可以验证，所以有些东西是只有发送方知道的，有些东西可以让任何人都知道。目前我们有签名生成过程中的一些中间量如r、s、z，**其中r和s构成了数字签名**，**z是接收方对接收到的数据取哈希结果**，在区块链比特币中通常称z为哈希数字摘要，**这三个量对接收方都是已知的**。此外还要椭圆曲线的两个参数a和b，大素数p，循环群生成元G，椭圆曲线群的秩n，secp256k1是个公开的算法，我都可以在网上找到这些参数，那这些参数也就是公开的，接收方肯定也会知道。此外还有公钥H 也是公开的，在“公钥生成”部分我也说过根据公钥要花几亿年才能求出私钥。此外还有一个随机数k
![image4](image4-15.png)

![image5](image5-14.png)

其它还可以分为三个层次，我们知道，实现椭圆曲线加密算法最核心的设计就是
点乘的运算，点乘的运算是产生密钥交换协议的基础，所以它是第一个层次。然后，
点乘的运算需要选取椭圆曲线上的点，那必然少不了点加以及倍点的点运算层，往往
在椭圆曲线上的点运算需要在有限域上进行域运算，这样，第三个层面就浮出了水面，
有限域的运算包括了模加运算、模乘运算、模逆运算等等。如图 2.2 所示，这样的结
构层次划分我们就更能直观的了解椭圆曲线加密算法在运算过程中的层次。
